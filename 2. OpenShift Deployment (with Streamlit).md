### OpenShift Deployment (with Streamlit)

---
You’ll deploy three main pods:
- patch-agent-api → FastAPI
- streamlit-ui → Streamlit app
- kb-service → Flask KB API
---
Dockerfile for Streamlit UI:
```dockerfile
# Dockerfile for Streamlit UI
FROM python:3.11-slim

WORKDIR /app
COPY streamlit_ui.py .

RUN pip install streamlit requests

EXPOSE 8501
CMD ["streamlit", "run", "streamlit_ui.py", "--server.port=8501", "--server.address=0.0.0.0"]
```
---
OpenShift Deployment YAML for Streamlit UI:
```yml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: streamlit-ui
spec:
  replicas: 1
  selector:
    matchLabels:
      app: streamlit-ui
  template:
    metadata:
      labels:
        app: streamlit-ui
    spec:
      containers:
      - name: streamlit-ui
        image: your-registry/streamlit-ui:latest
        ports:
        - containerPort: 8501
---
apiVersion: v1
kind: Service
metadata:
  name: streamlit-ui
spec:
  selector:
    app: streamlit-ui
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8501
---
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: streamlit-ui
spec:
  to:
    kind: Service
    name: streamlit-ui
  port:
    targetPort: 80
```
Component Summary:
- Streamlit UI → streamlit_ui.py (Dockerized)
- FastAPI API → app.py (Dockerized)
- KB Service → kb_service.py (Dockerized)
- Storage → PVC or MinIO
- Optional Worker → Add Celery later for async
